# Stoikov Bot - Single-Venue Risk-Averse Market Making

## π“– κ°μ”

Stoikov Botμ€ Avellaneda-Stoikov λ¨λΈμ„ κΈ°λ°μΌλ΅ ν• κ³ κΈ‰ λ‹¨μΌ κ±°λμ† λ§μΌ“λ©”μ΄ν‚Ή μ „λµμ…λ‹λ‹¤. μν•™μ μΌλ΅ μµμ ν™”λ νΈκ°€ μ κ³µκ³Ό μ •κµν• λ¦¬μ¤ν¬ κ΄€λ¦¬λ¥Ό ν†µν•΄ μ•μ •μ μΈ μμµμ„ μ¶”κµ¬ν•©λ‹λ‹¤.

### π― ν•µμ‹¬ νΉμ§•

- **μν•™μ  μµμ ν™”**: Stoikov λ¨λΈμ„ ν†µν• κ³Όν•™μ  νΈκ°€ κ³„μ‚°
- **μ‹¤μ‹κ°„ μ μ‘**: λ³€λ™μ„±κ³Ό κ±°λ κ°•λ„μ— λ”°λ¥Έ λ™μ  μ΅°μ •
- **μ •κµν• λ¦¬μ¤ν¬ κ΄€λ¦¬**: λ‹¤μΈµμ  λ¦¬μ¤ν¬ ν•λ„ λ° μλ™ μ°¨λ‹¨
- **κ³ μ„±λ¥ μ‹¤ν–‰**: λ°€λ¦¬μ΄ λ‹¨μ„ μµμ ν™”λ μ£Όλ¬Έ κ΄€λ¦¬
- **ν¬κ΄„μ  λ¨λ‹ν„°λ§**: 15κ°+ KPI μ‹¤μ‹κ°„ μ¶”μ 

## π“ μ „λµ μ›λ¦¬

### 1. Stoikov μν•™μ  λ¨λΈ

**μµμ  μ¤ν”„λ λ“ κ³„μ‚°:**
```
Ξ΄_t = Ξ³ΟƒΒ²/2k + ln(1 + Ξ³/k)/Ξ³
```

**μμ•½ κ°€κ²© (Reservation Price):**
```
r_t = mid_t - Ξ³ΟƒΒ²q_t
```

### 2. ν•µμ‹¬ νλΌλ―Έν„°

| νλΌλ―Έν„° | μ„¤λ… | κΈ°λ³Έκ°’ | λ²”μ„ |
|---------|------|--------|------|
| **Ξ³ (gamma)** | μ„ν— νν”Όλ„ | 0.6 | 0.3-1.2 |
| **Οƒ (sigma)** | λ³€λ™μ„± (EWMA) | 30s | 5s-5m |
| **k (lambda)** | κ±°λ κ°•λ„ | 60s | μ €/μ¤‘/κ³  |
| **q_max** | μµλ€ μΈλ²¤ν† λ¦¬ | 5% NAV | 2-10% |

### 3. μ‹¤ν–‰ νλΌλ―Έν„°

| νλΌλ―Έν„° | μ„¤λ… | κΈ°λ³Έκ°’ | λ²”μ„ |
|---------|------|--------|------|
| **PostOnly μ¤ν”„μ…‹** | ν‹± λ‹¨μ„ μ¤ν”„μ…‹ | Β±1 | Β±1-Β±3 |
| **TTL** | μ£Όλ¬Έ μƒλ…μ£ΌκΈ° | 800ms | 300-2000ms |
| **Repost κ°„κ²©** | μ¬νΈκ°€ κ°„κ²© | 200ms | 100-300ms |
| **Ladder λ λ²¨** | κ³„μΈµ μ£Όλ¬Έ μ | 2 | 1-3 |

## π›  μ„¤μ • λ°©λ²•

### 1. κΈ°λ³Έ μ„¤μ •

```json
{
  "id": "stoikov-mm-btc",
  "type": "StoikovBot",
  "name": "Stoikov Market Maker BTC",
  "enabled": false,
  "exchanges": ["binance"],
  "symbols": ["BTCUSDT"],
  "parameters": {
    "gamma": 0.6,
    "volatilityWindow": 30000,
    "maxInventoryPct": 5,
    "ttlMs": 800,
    "repostMs": 200,
    "ladderLevels": 2,
    "driftCutBps": 5,
    "sessionDDLimitPct": 0.5,
    "exchange": "binance",
    "symbol": "BTCUSDT"
  }
}
```

### 2. νλΌλ―Έν„° νλ‹ κ°€μ΄λ“

#### λ³΄μμ  μ„¤μ • (λ‚®μ€ μ„ν—)
```json
{
  "gamma": 1.0,
  "maxInventoryPct": 2,
  "driftCutBps": 3,
  "sessionDDLimitPct": 0.3
}
```

#### κ³µκ²©μ  μ„¤μ • (λ†’μ€ μμµ μ¶”κµ¬)
```json
{
  "gamma": 0.3,
  "maxInventoryPct": 10,
  "driftCutBps": 8,
  "sessionDDLimitPct": 1.0
}
```

#### κ³ λΉλ„ μ„¤μ • (λΉ λ¥Έ νμ „)
```json
{
  "ttlMs": 300,
  "repostMs": 100,
  "ladderLevels": 3,
  "alphaSizeRatio": 0.6
}
```

## π› μƒνƒλ¨Έμ‹  (State Machine)

```
MakerPlaced
β”β”€ Fill (λ΅±/μ μΈλ²¤ν† λ¦¬ λ³€ν™”) -> μ¬κ³„μ‚° -> μ–‘μΈ΅ μ¬νΈκ°€
β”β”€ PartialFill -> μ”λ‰λ§ μ¬κ²μ‹
β”β”€ TTL/OBλ³€ν™”/queueβ†‘ -> cancelReplace
β””β”€ Drift/DD μ΄κ³Ό -> Flat (μ‹μ¥κ°€/IOC) -> μ¬μ‹μ‘ or μΏ¨λ‹¤μ΄
```

### μƒνƒ μ „ν™ μ΅°κ±΄

1. **Fill**: μ£Όλ¬Έ μ²΄κ²° μ‹ μΈλ²¤ν† λ¦¬ μ—…λ°μ΄νΈ ν›„ μ¬κ³„μ‚°
2. **PartialFill**: λ¶€λ¶„ μ²΄κ²° μ‹ μ”λ‰λ§ μ¬κ²μ‹
3. **TTL λ§λ£**: μ£Όλ¬Έ μƒλ…μ£ΌκΈ° λ§λ£ μ‹ cancel-replace
4. **OB λ³€ν™”**: μ¤λ”λ¶ λ³€ν™”λ΅ μΈν• μ¬νΈκ°€ ν•„μ”
5. **Risk Limit**: λ¦¬μ¤ν¬ ν•λ„ μ΄κ³Ό μ‹ κ°•μ  μ²­μ‚°

## π“ λ¨λ‹ν„°λ§ KPI

### ν•µμ‹¬ μ„±λ¥ μ§€ν‘ (μ¤ν™ μ”κµ¬μ‚¬ν•­)

| KPI | μ„¤λ… | λ©ν‘ |
|-----|------|------|
| **μ ν¨ μ¤ν”„λ λ“** | μ‹¤μ  μ κ³µ μ¤ν”„λ λ“ (bp) | 2-10bp |
| **Fill Ratio** | μ£Όλ¬Έ μ²΄κ²°λ¥  (%) | >60% |
| **ν‰κ·  λ€κΈ°μ‹κ°„** | μ£Όλ¬Έ-μ²΄κ²° μ‹κ°„ (μ΄) | <2μ΄ |
| **Inventory Variance** | μΈλ²¤ν† λ¦¬ λ³€λ™μ„± | μµμ†ν™” |
| **μ„Έμ… DD** | μ„Έμ… μµλ€ μ†μ‹¤ (%) | <0.5% |
| **μ¬νΈκ°€/μ΄** | μ΄λ‹Ή μ¬νΈκ°€ νμ | <3ν |
| **κ±°μ λ¥ ** | μ£Όλ¬Έ κ±°μ λ¥  (%) | <5% |

### ν™•μ¥ λ©”νΈλ¦­

- **Fill Latency**: ν‰κ·  μ²΄κ²° μ§€μ—°μ‹κ°„ (ms)
- **Market Share**: κ±°λλ‰ μ μ μ¨ (%)
- **Adverse Selection**: μ—­μ„ νƒ λΉ„μ¨
- **Inventory Turnover**: μΈλ²¤ν† λ¦¬ νμ „μ¨
- **Risk-Adjusted PnL**: μ„ν— μ΅°μ • μμµλ¥ 

## β οΈ λ¦¬μ¤ν¬ κ΄€λ¦¬

### 1. μλ™ λ³΄νΈ μ¥μΉ

| λ¦¬μ¤ν¬ νƒ€μ… | μ„κ³„κ°’ | μ΅°μΉ |
|------------|--------|------|
| **μΈλ²¤ν† λ¦¬ μ΄κ³Ό** | NAV 5% | ν¬μ§€μ… μ²­μ‚° |
| **κ°€κ²© λ“λ¦¬ν”„νΈ** | 5bp | ν¬μ§€μ… μ²­μ‚° |
| **μ„Έμ… DD** | NAV 0.5% | ν¬μ§€μ… μ²­μ‚° |
| **μΌμΌ DD** | NAV 1.0% | λ΄‡ μ •μ§€ |
| **μ—°μ† μ‹¤ν¨** | 10ν | μ„μ‹ μ¤‘λ‹¨ |
| **λ³€λ™μ„± κΈ‰μ¦** | 200% | μ¤ν”„λ λ“ ν™•λ€ |

### 2. λ™μ  μ΅°μ •

- **μ‚¬μ΄μ¦ μ΅°μ •**: λ¦¬μ¤ν¬ λ λ²¨μ— λ”°λ¥Έ μ£Όλ¬Έ ν¬κΈ° μ¶•μ†
- **μ¤ν”„λ λ“ ν™•λ€**: κ³ λ³€λ™μ„± μ‹ μ•μ „ λ§μ§„ μ¦κ°€
- **μΏ¨λ‹¤μ΄**: λ¦¬μ¤ν¬ μ΄λ²¤νΈ ν›„ μλ™ ν΄μ‹

### 3. μ‘κΈ‰ μƒν™© λ€μ‘

```bash
# κΈ΄κΈ‰ μ •μ§€
POST /api/bots/{botId}/emergency-stop

# ν¬μ§€μ… κ°•μ  μ²­μ‚°
POST /api/bots/{botId}/flatten

# λ¦¬μ¤ν¬ ν•λ„ μ„μ‹ λ³€κ²½
PUT /api/bots/{botId}/risk-limits
```

## π–¥ CLI μ‚¬μ©λ²•

### 1. CLIμ—μ„ λ΄‡ μ¶”κ°€

```bash
npm run dev:cli
# -> β• μƒ λ΄‡ μ¶”κ°€ν•κΈ°
# -> StoikovBot μ„ νƒ
# -> νλΌλ―Έν„° μ„¤μ •
```

### 2. μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§

```bash
# μ‹¤μ‹κ°„ λ€μ‹λ³΄λ“
# -> π”„ μ‹¤μ‹κ°„ λ€μ‹λ³΄λ“

# μ„±λ¥ λ³΄κ³ μ„
# -> π“ μ„±λ¥ λ³΄κ³ μ„

# KPI μƒμ„Έ λ³΄κΈ°
# -> π“ λ΄‡ μƒνƒ
```

### 3. νλΌλ―Έν„° μ‹¤μ‹κ°„ μ΅°μ •

```bash
# -> β™οΈ λ΄‡ μ„¤μ • μμ •
# -> νλΌλ―Έν„° μ„ νƒ
# -> κ°’ λ³€κ²½ (μ¦‰μ‹ μ μ©)
```

## π”§ κ³ κΈ‰ μ„¤μ •

### 1. νƒ€μ„μ΅΄ ν”„λ΅ν•„

```json
{
  "timezoneProfile": "asia",    // μ•„μ‹μ•„ μ‹κ°„λ€ μµμ ν™”
  "timezoneProfile": "eu",      // μ λ½ μ‹κ°„λ€ μµμ ν™”  
  "timezoneProfile": "us",      // λ―Έκµ­ μ‹κ°„λ€ μµμ ν™”
  "timezoneProfile": "global"   // κΈ€λ΅λ² 24μ‹κ°„
}
```

### 2. λ³€λ™μ„± μ²΄μ λ³„ μ΅°μ •

```json
{
  "volRegimeScaler": 0.3,  // λ³΄μμ  (λ‚®μ€ λ³€λ™μ„± μ‹ μ¤ν”„λ λ“ μ¶•μ†)
  "volRegimeScaler": 0.5,  // κ· ν•μ 
  "volRegimeScaler": 0.8   // κ³µκ²©μ  (λ†’μ€ λ³€λ™μ„± μ‹ μ¤ν”„λ λ“ ν™•λ€)
}
```

### 3. μ¤λ”λ¶ κ°€μ¤‘μΉ

```json
{
  "obiWeight": 0,    // OBI λ―Έμ‚¬μ©
  "obiWeight": 0.3,  // μ¤‘κ°„ κ°€μ¤‘μΉ
  "obiWeight": 0.5   // λ†’μ€ κ°€μ¤‘μΉ (λ¶κ· ν• λ°μ)
}
```

## π“ λ°±ν…μ¤ν… λ° μµμ ν™”

### 1. νλΌλ―Έν„° μµμ ν™” μ μ°¨

1. **κΈ°λ³Έ μ„¤μ •μΌλ΅ 1μ£ΌμΌ μ΄μ**
2. **KPI λ¶„μ„ ν›„ λ¬Έμ μ  νμ•…**
3. **νλΌλ―Έν„° λ‹¨κ³„μ  μ΅°μ •**
4. **A/B ν…μ¤νΈλ΅ μ„±λ¥ λΉ„κµ**
5. **μµμ κ°’ λ„μ¶ ν›„ μ μ©**

### 2. μ„±κ³Ό λ²¤μΉλ§ν‚Ή

- **μ‹μ¥ λ€λΉ„ μ„±κ³Ό**: SPX/BTC λ€λΉ„ μ„ν—μ΅°μ •μμµλ¥ 
- **κ²½μ MM λ€λΉ„**: λ‹¤λ¥Έ λ§μΌ“λ©”μ΄μ»¤ λ€λΉ„ spread/volume
- **λ‚΄λ¶€ κΈ°μ¤€**: λ©ν‘ Sharpe ratio >1.5

## π¨ μ£Όμμ‚¬ν•­

### 1. μ‹μ¥ μƒν™©λ³„ λ€μ‘

- **λ‰΄μ¤ μ΄λ²¤νΈ**: μλ™ μ¤ν”„λ λ“ ν™•λ€ λ° μ‚¬μ΄μ¦ μ¶•μ†
- **κΈ‰λ³€λ™**: μ„μ‹ μ¤‘λ‹¨ ν›„ λ³€λ™μ„± μ•μ •ν™” λ€κΈ°
- **μ €μ λ™μ„±**: λ” λ„“μ€ μ¤ν”„λ λ“μ™€ μ‘μ€ μ‚¬μ΄μ¦λ΅ μ΅°μ •

### 2. μ •κΈ° μ κ²€μ‚¬ν•­

- **μΌμΌ**: μ„Έμ… μ„±κ³Ό λ° λ¦¬μ¤ν¬ λ©”νΈλ¦­ ν™•μΈ
- **μ£Όκ°„**: νλΌλ―Έν„° μµμ ν™” λ° μ‹μ¥ μ²΄μ  λ¶„μ„  
- **μ›”κ°„**: μ „λµ μ„±κ³Ό ν‰κ°€ λ° μ—…κ·Έλ μ΄λ“ κ²€ν† 

### 3. λ°±μ—… λ° λ³µκµ¬

- **μ„¤μ • λ°±μ—…**: νλΌλ―Έν„° μ„ΈνΈλ³„ λ²„μ „ κ΄€λ¦¬
- **λ΅κ·Έ λ³΄κ΄€**: μµμ† 30μΌ κ±°λ κΈ°λ΅ μ μ§€
- **λ³µκµ¬ μ μ°¨**: μ¥μ•  μ‹ μλ™ μ•μ „λ¨λ“ μ „ν™

## π“ μ°Έκ³  μλ£

- [Avellaneda-Stoikov λ…Όλ¬Έ](https://www.math.nyu.edu/faculty/avellane/HighFrequencyTrading.pdf)
- [Market Making μ΄λ΅ ](https://stanford.edu/~ashishg/msande444/lectures/lecture13.pdf)
- [Risk Management Best Practices](https://www.risk.net/cutting-edge/banking/2419087/optimal-execution-algorithmic-trading)